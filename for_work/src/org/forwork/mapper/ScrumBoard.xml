<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">



<mapper namespace="org.forwork.mapper.ScrumBoardMapper">
	<cache />
	
	<insert id="insertTask" parameterType="Task">
		insert into task_ex(
		TASK_CONTENT, task_type_id, task_id, task_index
		)
		values(
		#{task_content}, 1, task_ex_seq.nextval, #{task_index}
		)
	
	</insert>
	
	<select id="getStoriesIndex" resultType="int">
		select max(task_index) from task_ex where task_type_id = 1
	</select>
	
	<select id="listTask"  resultType="Task">
		select task_id, task_content, responsibility, writer, task_type_id,task_index from task_ex order by task_index
	</select>
	
	<delete id="deleteTask" parameterType="int">
		delete from board where seq = #{seq}	
	</delete>
	
	<!-- project id 조건에 추가하기 -->
	<select id="getTask" parameterType="String" resultType="Task">
		select * from task_ex where task_id = #{task_id}
	</select>
	
	
	<update id="updateTask" parameterType="Task">
		update task_ex set task_type_id = #{task_type_id},task_index = #{task_index} where task_id = #{task_id}
	</update>
	 
	<update id="increaseIndex" parameterType="Task">
		update task_ex set task_index = task_index+1 where task_id != #{task_id} and task_type_id = #{task_type_id} and task_index >= #{task_index}
	</update>
	
	<update id="decreaseIndex" parameterType="Task">
		update task_ex set task_index = task_index-1 where task_type_id = #{task_type_id} and task_index > #{task_index}	
	</update>
	
</mapper>















